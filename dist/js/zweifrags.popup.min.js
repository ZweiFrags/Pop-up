var tmdiv,tmfgr,opened,allGalAttr,index,currentImgIndex,pppImg,ArrAllGalAttr,lnghtofarr,hrefOfAjax,idOfAjax,trgtAjax,maxw=.9*window.innerWidth,maxh=.9*window.innerHeight;function checkGallery(t){if(t.hasAttribute("data-ppp-gal")){var e=t.getAttribute("data-ppp-gal");lnghtofarr=(ArrAllGalAttr=Array.from(document.querySelectorAll('[data-ppp-gal="'+e+'"]'))).length;var a=document.createElement("div");a.className="ppp_cntrls",a.innerHTML='<div class="ppp_prev" onclick="showimg(-1)">〈</div>     <div class="ppp_next" onclick="showimg(1)">〉</div>',Array.from(document.querySelectorAll("figure")).pop().appendChild(a),ArrAllGalAttr.forEach((t,e)=>{t.classList.contains("opened")&&(currentImgIndex=e)})}}function GetSomeData(){fetch(hrefOfAjax).then(t=>t.text()).then(t=>{let e=new DOMParser,a=e.parseFromString(t,"text/html"),r=a.getElementById(idOfAjax);void 0===r.attributes.src&&r.attributes.data,checkTitle(r)})}function checkImage(t){let e=t.getAttribute("src"),a=t.getAttribute("data-src");if(e||a)(out=document.createElement("img")).setAttribute("src",null!==e?e:a);else{var r=document.createElement("div");r.classList.add("ppp_txtwrap"),r.insertAdjacentHTML("beforeend",t.innerHTML),out=r}return out}function buildMdl(t){var e=document.createElement("div");e.className="ppp","object"==typeof t&&(t=t.outerHTML),e.innerHTML='<div class="ppp_hldr"><figure id="ppp" class="marginppp">'+t+'</figure><div class="ppp_close">\xd7</div></div>',document.body.appendChild(e)}function showimg(t){var e=document.getElementById("ppp"),a=e.getElementsByTagName("img");(currentImgIndex+=t)==lnghtofarr&&(currentImgIndex=0),-1==currentImgIndex&&(currentImgIndex=lnghtofarr-1);let r=ArrAllGalAttr[currentImgIndex].getAttribute("src"),i=ArrAllGalAttr[currentImgIndex].getAttribute("data-src"),p=null!==r?r:i,d=new Image;d.src=p,a[0].setAttribute("style","width:"+a[0].offsetWidth+"px;height:"+a[0].offsetHeight+"px"),e.classList.add("ppp_loader"),d.onload=function(){e.classList.add("ppp_fade"),e.classList.remove("ppp_loader");let t=d.width/d.height,r=maxw<d.width?maxw:d.width,i=maxh<d.height?maxh:d.height;i*t>r?i=r/t:r=i*t;let n,l;clearTimeout(n),clearTimeout(l),n=setTimeout(function(){a[0].src=p,a[0].setAttribute("style","width:"+r+"px;height:"+i+"px")},200),l=setTimeout(()=>{e.classList.remove("ppp_fade")},300)};var n=e.getElementsByTagName("figcaption");if(ArrAllGalAttr[currentImgIndex].hasAttribute("data-ppp-title")){var l=ArrAllGalAttr[currentImgIndex].getAttribute("data-ppp-title");n[0].innerHTML=l}else n[0].innerHTML=""}function checkTitle(t){fgrttl=document.createElement("div");let e=t.hasAttribute("data-ppp-title")?t.getAttribute("data-ppp-title"):"";fgrttl.innerHTML="<figcaption>"+e+"</figcaption>",document.getElementById("ppp").appendChild(fgrttl)}function buildFrm(t){var e=document.createElement("div");e.id="mark",t.after(e),t.removeAttribute("data-ppp"),t.removeAttribute("data-ppp-form"),document.body.insertAdjacentHTML("beforeend",'<div class="ppp"><div class="ppp_hldr"><figure id="ppp" class="ppp_txtwrap marginppp "></figure><div class="ppp_close">\xd7</div></div></div>');document.getElementById("ppp").insertAdjacentElement("afterbegin",t)}window.addEventListener("resize",()=>{maxw=.9*window.innerWidth,maxh=.9*window.innerHeight}),document.addEventListener("click",function(t){if(t.target.hasAttribute("data-ppp-id")){var e=t.target.getAttribute("data-ppp-id");if(t.target.hasAttribute("data-ppp-form"))buildFrm(document.getElementById(e));else if(document.contains(document.getElementById(e))&&void 0!=document.getElementById(e).getAttribute("src"))buildMdl(document.getElementById(e));else{var a=document.getElementById(e).innerHTML;buildMdl(a)}}if(t.target&&["ppp_close","ppp"].includes(t.target.className)){var r=t.target.closest(".ppp");if(document.getElementById("mark")){var i=document.getElementById("mark"),p=this.getElementById("ppp").children[0];p.setAttribute("data-ppp",""),p.setAttribute("data-ppp-form",""),i.insertAdjacentElement("afterend",p),insertedElement=i.parentNode.insertBefore(p,i),i.remove()}r.classList.add("ppp_out"),setTimeout(function(){r.remove()},400),void 0!=opened&&opened.classList.remove("opened")}hrefOfAjax=t.target.getAttribute("href"),"ajax"==t.target.getAttribute("data-href")&&void 0!=hrefOfAjax&&(idOfAjax=t.target.getAttribute("data-ajax-id"),trgtAjax=document.querySelector("[data-ajax-id]",idOfAjax),GetSomeData(hrefOfAjax)),t.target.hasAttribute("data-ppp")&&(t.target.hasAttribute("data-ppp-form")?buildFrm(t.target):(a=checkImage(t.target),t.target.classList.add("opened"),opened=t.target,buildMdl(a),checkTitle(t.target),checkGallery(t.target),t.target.hasAttribute("data-ppp-pos")&&document.getElementsByClassName("ppp_hldr")[0].classList.add(t.target.getAttribute("data-ppp-pos"))))});